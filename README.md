# ğŸ¯ PR Orchestrator

**Transform task breakdowns into structured Pull Requests for parallel agent execution**

---

## ğŸ“– Overview

PR Orchestrator is a coordination layer that bridges the gap between task analysis (from TaskMaster or manual planning) and distributed execution via GitHub Pull Requests.

### The Problem

When working on complex features:
- Tasks are analyzed and broken down (manually or via TaskMaster)
- Multiple agents (AI or human) could work in parallel
- But coordination is manual and error-prone
- Dependencies are hard to track
- Context gets lost between tasks

### The Solution

PR Orchestrator:
1. Takes structured task definitions (`tasks.yaml`)
2. Analyzes dependencies and complexity
3. Creates GitHub PRs with complete context
4. Manages labels for coordination
5. Enables parallel agent execution

---

## ğŸ¯ Position in the Workflow

```
Idea/Feature Request
    â†“
TRD (Technical Requirements)
    â†“
TDD (Test-Driven Development)
    â†“
TaskMaster (external tool)
  - Codebase analysis
  - Complexity calculation
  - Task/subtask breakdown
  OUTPUT: tasks.yaml
    â†“
PR ORCHESTRATOR (this tool)
  - Parse tasks.yaml
  - Generate priming prompts
  - Create Git branches
  - Create GitHub PRs
  - Configure dependencies
  OUTPUT: Ready PRs
    â†“
Agents (Claude, humans, etc.)
  - Pick available PRs
  - Read context & prompt
  - Implement
  - Merge
```

---

## ğŸ“ Project Structure

```
pr-orchestrator/
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ ARCHITECTURE.md      # System architecture
â”‚   â”œâ”€â”€ WORKFLOW.md          # Detailed workflow
â”‚   â””â”€â”€ BUSINESS_LOGIC.md    # Business rules & algorithms
â”‚
â”œâ”€â”€ contracts/
â”‚   â”œâ”€â”€ tasks.yaml           # Input format (from TaskMaster)
â”‚   â”œâ”€â”€ config.yaml          # Configuration schema
â”‚   â”œâ”€â”€ state.json           # State tracking schema
â”‚   â””â”€â”€ context.json         # Task context schema
â”‚
â”œâ”€â”€ examples/
â”‚   â””â”€â”€ simple-crud/
â”‚       â””â”€â”€ tasks.yaml       # Example project
â”‚
â”œâ”€â”€ src/                     # (To be implemented)
â”‚   â”œâ”€â”€ parsers/             # Input parsing
â”‚   â”œâ”€â”€ generators/          # Prompt & content generation
â”‚   â”œâ”€â”€ managers/            # Git, PR, Label management
â”‚   â””â”€â”€ orchestrator.py      # Main entry point
â”‚
â””â”€â”€ README.md               # This file
```

---

## ğŸš€ Quick Start (Conceptual)

### 1. Prepare Input

```yaml
# tasks.yaml (generated by TaskMaster)
project:
  name: "My Feature"
  repo_url: "https://github.com/user/repo"

tasks:
  - id: 1
    name: "Database Schema"
    complexity: 45
    estimated_hours: 3.0
    dependencies: []
    # ... more details

  - id: 2
    name: "API Endpoints"
    complexity: 60
    estimated_hours: 4.5
    dependencies: [1]
    # ... more details
```

### 2. Run Orchestrator

```bash
pr-orchestrator init tasks.yaml
```

### 3. Result

```
âœ… 5 PRs created:
   PR #42: Task 1 - Database Schema (Ready ğŸŸ¢)
   PR #43: Task 2 - API Endpoints (Blocked ğŸ”´ by Task 1)
   PR #44: Task 3 - Frontend UI (Blocked ğŸ”´ by Task 2)
   ...

Next steps:
  - Agents can start on PR #42 immediately
  - When PR #42 merged â†’ PR #43 auto-unblocks
  - Track progress: .pr-orchestrator/state.json
```

### 4. Agent Workflow

```bash
# Agent picks available PR
gh pr list --label "ready-to-work"

# Checkout branch
gh pr checkout 42

# Read context
cat .pr-orchestrator/tasks/task_1/context.json

# See priming prompt
# ROLE: Expert Python/SQLAlchemy Developer
# TASK: Create database schema...
# CONTEXT: ...
# CONSTRAINTS: ...
# SUCCESS CRITERIA: ...

# Implement
# ... code ...

# Merge
gh pr merge 42 --squash

# Task 2 is now automatically unblocked ğŸ‰
```

---

## ğŸ§© Key Features

### 1. Dependency Management
- Automatic dependency graph construction
- Cycle detection
- Ready/blocked status tracking
- Auto-unblocking when dependencies complete

### 2. Context Preservation
- Each PR contains complete context
- Priming prompts for agents
- Todo checklists
- Success criteria
- File lists
- Pattern references

### 3. Parallel Execution
- Identifies tasks that can run in parallel
- Calculates critical path
- Estimates parallelism gains
- Supports multiple agents simultaneously

### 4. Progress Tracking
- State saved in `state.json`
- Labels for visual tracking
- Summary reports
- Resume capability after interruption

---

## ğŸ“Š Example: Dependency Graph

```
Task 1 (DB) â”€â”€â”€â”€â”¬â”€â”€â†’ Task 2 (API) â”€â”€â†’ Task 3 (UI)
  3h            â”‚       4.5h              6h
  Ready ğŸŸ¢      â”‚     Blocked ğŸ”´      Blocked ğŸ”´
                â”‚
                â””â”€â”€â†’ Task 4 (Tests)
                        3h
                     Blocked ğŸ”´

Task 5 (Docs)
  2h
  Ready ğŸŸ¢ (independent)

Sequential: 18.5h
Parallel: 13.5h (critical path: 1â†’2â†’3)
Gain: 27% faster
```

---

## ğŸ¨ Generated PR Structure

Each PR contains:

```markdown
# ğŸ¯ Task 1: Database Schema

**Status**: ğŸŸ¢ Ready
**Complexity**: 45
**Estimated**: 3.0h
**Priority**: High

---

## ğŸ“‹ Description
Create database schema for user management...

---

## ğŸ¤– Priming Prompt
```
ROLE: Expert Python/SQLAlchemy Developer
TASK: Setup PostgreSQL schema...
CONTEXT: ...
CONSTRAINTS: ...
SUCCESS CRITERIA: ...
```

---

## âœ… Todo List
- [ ] Create User model
- [ ] Create Role model
- [ ] Create migration
- [ ] Write tests

---

## ğŸ”— Dependencies
**Blocks**: Task 2, Task 4
**Blocked by**: None

---

## ğŸ“ Files
- models/user.py [NEW]
- models/role.py [NEW]
- migrations/001_schema.py [NEW]

---

## ğŸ¨ Patterns
- /patterns/database-model.py
```

---

## ğŸ”§ Configuration

```yaml
# .pr-orchestrator.yaml
git:
  base_branch: main
  branch_prefix: pr-orchestrator

github:
  platform: github
  draft_by_default: true

labels:
  ready: "ready-to-work"
  blocked: "blocked"

prompts:
  template: default
  role_inference: auto
```

---

## ğŸ“š Documentation

- **[ARCHITECTURE.md](docs/ARCHITECTURE.md)** - System design & components
- **[WORKFLOW.md](docs/WORKFLOW.md)** - Detailed workflow & processes
- **[BUSINESS_LOGIC.md](docs/BUSINESS_LOGIC.md)** - Rules & algorithms

---

## ğŸ¯ Design Principles

1. **Input Agnostic**: Works with TaskMaster output or manual plans
2. **Platform Flexible**: GitHub, GitLab, Bitbucket support
3. **Agent Agnostic**: Works with AI agents or humans
4. **Fail Fast**: Strict validation, clear errors
5. **Resumable**: Can recover from interruptions
6. **Observable**: State tracking, logs, reports

---

## ğŸš€ Future: Claude Skill

This will be packaged as a Claude Skill:

```bash
# Future usage
claude orchestrate tasks.yaml

# With auto-assignment
claude orchestrate tasks.yaml --agents 3

# With monitoring
claude orchestrate tasks.yaml --dashboard
```

---

## ğŸ“Š Status

**Current**: Architecture & Design Phase âœ…
**Next**: Implementation
**Future**: Claude Skill Integration

---

## ğŸ’¡ Use Cases

### Solo Developer
- Organize complex features
- Track progress visually
- Clear history via PRs

### Small Team
- Coordinate parallel work
- Automatic dependency tracking
- No manual coordination needed

### Multi-Agent AI
- Scale with multiple Claude instances
- Automatic work distribution
- GitHub-based coordination

---

## ğŸ¤ Integration Points

### Input
- TaskMaster (external analysis tool)
- Manual task definitions
- Other planning tools (via YAML/JSON)

### Output
- GitHub PRs
- GitLab Merge Requests
- Bitbucket Pull Requests
- Azure DevOps Pull Requests

### Notifications
- Slack webhooks
- Discord webhooks
- Email
- Custom webhooks

---

## ğŸ“– Related Docs

- TaskMaster (external tool for codebase analysis)
- TRD/TDD process documentation
- Claude Skill documentation (future)

---

**Version**: 1.0.0 (Design)
**License**: TBD
**Status**: Ready for implementation

---

## ğŸ“ Key Concepts

### Tasks
Atomic units of work with clear objectives, generated from TaskMaster analysis

### Dependencies
Explicit relationships between tasks (Task B depends on Task A)

### Priming Prompts
Contextual instructions for agents executing tasks

### State
Tracked progress and metadata in `.pr-orchestrator/state.json`

### Coordination
Achieved via GitHub labels and branch/PR management

---

**Ready to migrate to standalone repository** ğŸš€
